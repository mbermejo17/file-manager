(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

////////////////////////////////////
// Users manage module
///////////////////////////////////

var searchUserName = function searchUserName(userName) {
  if (RunMode === "DEBUG") console.log(userName);

  execFetch("/searchuser?userName=" + userName, "GET", null).then(function (d) {
    if (RunMode === "DEBUG") console.log(d);
    if (d.status == "OK") {
      showAddUserForm("Edit User", d.data);
    } else {
      showToast(d.message, "err");
    }
  }).catch(function (e) {
    showToast("Error al buscar usuario " + userName + ".<br>Err:" + e, "err");
    if (RunMode === "DEBUG") console.log(e);
  });
};

var LoadUsersList = function LoadUsersList(el) {
  execFetch("/users", "GET").then(function (d) {
    if (RunMode === "DEBUG") console.log(d);
    var users = d.data;
    var options = '';
    for (var x = 0; x < users.length; x++) {
      options += "<option id=\"" + users[x].UserId + "\">" + users[x].UserName + "</option>";
    }
    el.innerHTML = options;
  }).catch(function (e) {
    showToast("Error al grabar los cambios para el usuario " + data.userName + ".<br>Err:" + e, "err");
    if (RunMode === "DEBUG") console.log(e);
  });
};

var editUser = function editUser() {
  var AddUserModalContent = document.querySelector("#AddUserModalContent");
  var SearchUserModalContent = document.querySelector("#searchUserModalContent");

  var containerOverlay = document.querySelector(".container-overlay");
  AddUserModalContent.style.display = "none";
  SearchUserModalContent.innerHTML = htmlSearchUserTemplate;
  LoadUsersList(document.getElementById('usersList'));
  SearchUserModalContent.style.display = "block";
  containerOverlay.style.display = "block";
  SearchUserModalContent.addEventListener("keyup", function (e) {
    e.preventDefault();
    if (e.keyCode === 13) {
      searchUserName(document.getElementById("searchUserName").value);
    }
  });
  document.querySelector("#btnSearchUser").addEventListener("click", function (e) {
    e.preventDefault();
    searchUserName(document.getElementById("searchUserName").value);
  });
  document.querySelector("#btn-SearchUserCancel").addEventListener("click", function (e) {
    e.preventDefault();
    SearchUserModalContent.style.display = "none";
    containerOverlay.style.display = "none";
  });
};

var selectRole = function selectRole(element, role) {
  if (RunMode === "DEBUG") console.log(role);
  for (var x = 0; x < element.options.length; x++) {
    if (RunMode === "DEBUG") console.log("option: ", element.options[x].text);
    if (element.options[x].text.toUpperCase() === role.toUpperCase()) {
      element.options[x].selected = "selected";
      element.selectedIndex = x;
      if (RunMode === "DEBUG") console.log("option selected: ", element.options[x].text);
      if (role.toUpperCase() !== "CUSTOM") {
        changeAccessRights(document.querySelectorAll(".AccessRightsSwitch"), element.options[x].value);
      }
      break;
    }
  }
};

var showAddUserForm = function showAddUserForm(title, data) {
  var AddUserModalContent = document.querySelector("#AddUserModalContent");
  var containerOverlay = document.querySelector(".container-overlay");
  var SearchUserModalContent = document.querySelector("#searchUserModalContent");
  var mode = data ? "edit" : "add";
  var oldData = null;
  SearchUserModalContent.style.display = "none";

  AddUserModalContent.innerHTML = htmlUserFormTemplate;
  if (data) {
    if (RunMode === "DEBUG") console.log(data);
    oldData = _extends({}, data);
    document.querySelector("#userFormTitle").innerHTML = title;
    document.querySelector("#UserName").value = data.UserName;
    document.querySelector("#CompanyName").value = data.CompanyName;
    document.querySelector("#UserPasswd").value = data.UserPasswd;
    document.querySelector("#repeatUserPasswd").value = data.UserPasswd;
    document.querySelector("#RootPath").value = data.RootPath;
    document.querySelector("#ExpirateDate").value = data.ExpirateDate;
    //document.querySelector("#expirationDate")
    selectRole(document.querySelector("#RoleOptions"), data.Role);
    if (data.Role.toUpperCase() === "CUSTOM") checkAccessRights(data.AccessString);
    containerOverlay.style.display = "block";
    AddUserModalContent.style.display = "block";
    document.querySelector("label[for=UserName]").classList.add("active");
    document.querySelector("label[for=CompanyName]").classList.add("active");
    document.querySelector("label[for=UserPasswd]").classList.add("active");
    document.querySelector("label[for=repeatUserPasswd]").classList.add("active");
    document.querySelector("label[for=RootPath]").classList.add("active");
    document.querySelector("#UserName").disabled = true;

    document.querySelector("#btn-addUserCancel").addEventListener("click", function (e) {
      e.preventDefault();
      //containerOverlay.style.display = "none";
      AddUserModalContent.style.display = "none";
      SearchUserModalContent.style.display = "block";
    });
    document.querySelector("#btn-addUserAcept").addEventListener("click", function (e) {
      e.preventDefault();
      _updateUser(oldData);
    });
  } else {
    containerOverlay.style.display = "block";
    AddUserModalContent.style.display = "block";
    changeAccessRights(document.querySelectorAll(".AccessRightsSwitch"), "opt1");
    document.querySelector("#btn-addUserCancel").addEventListener("click", function (e) {
      e.preventDefault();
      containerOverlay.style.display = "none";
      AddUserModalContent.style.display = "none";
    });
    document.querySelector("#btn-addUserAcept").addEventListener("click", function (e) {
      e.preventDefault();
      _addUser();
    });
  }

  var sel = document.querySelector("select");

  $(".AccessRightsSwitch").change(function () {
    if ($(this).is(":checked")) {
      if (RunMode === "DEBUG") console.log("Is checked");
    } else {
      if (RunMode === "DEBUG") console.log("Is Not checked");
    }
  });

  sel.addEventListener("change", function (e) {
    var opt = e.target[e.target.selectedIndex].value;
    var AccessSwitch = document.querySelectorAll(".AccessRightsSwitch");
    changeAccessRights(AccessSwitch, opt);
  });

  var _getUserRole = function _getUserRole() {
    return sel.options[sel.selectedIndex].text;
  };

  var _getChanges = function _getChanges() {
    var AccessSwitch = document.querySelectorAll(".AccessRightsSwitch");
    var accessString = _getAccessString(AccessSwitch);
    var userRole = _getUserRole();
    var queryString = {};
    if (RunMode === "DEBUG") console.log(oldData);
    for (var prop in oldData) {
      if (hasOwnProperty.call(oldData, prop)) {
        console.log(prop);
        if (prop === "Role") {
          if (oldData[prop].toUpperCase() !== userRole.toUpperCase()) {
            queryString.Role = userRole;
            console.warn(oldData[prop], userRole);
          } else {
            console.log(oldData[prop], userRole);
          }
        } else {
          if (prop === "AccessString") {
            if (oldData[prop] !== accessString) {
              console.warn(oldData[prop], accessString);
              queryString.AccessString = accessString;
            } else {
              console.log(oldData[prop], accessString);
            }
          } else {
            if (prop === 'ExpirateDate') {
              if (oldData[prop] === null) oldData[prop] = '';
              if (oldData[prop] !== document.getElementById(prop).value) {
                queryString.ExpirateDate = document.getElementById(prop).value;
                console.warn(oldData[prop], document.getElementById(prop).value);
              } else {
                console.log(oldData[prop], document.getElementById(prop).value);
              }
            } else {
              if (oldData[prop].toUpperCase() !== document.getElementById(prop).value.toUpperCase()) {
                queryString[prop] = document.getElementById(prop).value;
                console.warn(oldData[prop], document.getElementById(prop).value);
              } else {
                console.log(oldData[prop], document.getElementById(prop).value);
              }
            }
          }
        }
      }
    }
    if (RunMode === 'DEBUG') console.log(queryString);
    return queryString;
  };

  var _updateUser = function _updateUser(oData) {
    var queryString = _getChanges();
    if (queryString) {
      var _data = {
        userName: oData.UserName,
        queryString: queryString
      };
      execFetch("/updateuser", "POST", _data).then(function (d) {
        if (RunMode === "DEBUG") console.log(d);
        showToast("Datos usuario " + _data.userName + " actualizados.", "success");
        document.getElementById("refresh").click();
      }).catch(function (e) {
        showToast("Error al grabar los cambios para el usuario " + _data.userName + ".<br>Err:" + e, "err");
        if (RunMode === "DEBUG") console.log(e);
      });
    }
  };

  var _getAccessString = function _getAccessString(AccessSwitch) {
    var result = "";
    var v = 0;

    for (var x = 0; x < AccessSwitch.length; x++) {
      if (AccessSwitch[x].checked) {
        v = 1;
      } else {
        v = 0;
      }
      if (x != 0) {
        result += "," + v;
      } else {
        result += v;
      }
    }
    return result;
  };

  var _addUser = function _addUser() {
    var AccessSwitch = document.querySelectorAll(".AccessRightsSwitch");
    var userName = document.querySelector("#UserName").value;
    var companyName = document.querySelector("#CompanyName").value;
    var userPassword = document.querySelector("#UserPasswd").value;
    var userRole = sel[sel.selectedIndex].innerHTML;
    var userRootPath = document.querySelector("#RootPath").value;
    var expirateDate = document.querySelector("#ExpirateDate").value;
    var result = _getAccessString(AccessSwitch);

    if (RunMode === "DEBUG") console.log("User Name: " + userName);
    if (RunMode === "DEBUG") console.log("Company Name: " + companyName);
    if (RunMode === "DEBUG") console.log("Password: " + userPassword);
    if (RunMode === "DEBUG") console.log("Root Path: " + userRootPath);
    if (RunMode === "DEBUG") console.log("Expirate Date: " + expirateDate);
    if (RunMode === "DEBUG") console.log("Role: " + userRole);
    if (RunMode === "DEBUG") console.log("Access Rights: " + result);
    var data = {
      userName: userName,
      userPassword: Base64.encode(md5(userPassword)),
      companyName: companyName,
      userRole: userRole,
      expirateDate: expirateDate,
      rootPath: userRootPath,
      accessRights: result
    };
    execFetch("/adduser", "POST", data).then(function (d) {
      if (RunMode === "DEBUG") console.log(d);
      showToast("Usuario " + data.userName + " añadido.", "success");
      document.getElementById("refresh").click();
      document.querySelector("#formAddUser").reset();
      changeAccessRights(document.querySelectorAll(".AccessRightsSwitch"), "opt1");
    }).catch(function (e) {
      showToast("Error al añadir usuario " + data.userName + ".<br>Err:" + e, "err");
      if (RunMode === "DEBUG") console.log(e);
    });
  };
};

////////////////////////////////////
// End user manage module
///////////////////////////////////

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9tb2R1bGVzL3VzZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDQ0U7QUFDQTtBQUNBOztBQUVBLElBQU0saUJBQWlCLFNBQWpCLGNBQWlCLFdBQVk7QUFDakMsTUFBSSxZQUFZLE9BQWhCLEVBQXlCLFFBQVEsR0FBUixDQUFZLFFBQVo7O0FBRXpCLFlBQVUsMEJBQTBCLFFBQXBDLEVBQThDLEtBQTlDLEVBQXFELElBQXJELEVBQ0csSUFESCxDQUNRLGFBQUs7QUFDVCxRQUFJLFlBQVksT0FBaEIsRUFBeUIsUUFBUSxHQUFSLENBQVksQ0FBWjtBQUN6QixRQUFJLEVBQUUsTUFBRixJQUFZLElBQWhCLEVBQXNCO0FBQ3BCLHNCQUFnQixXQUFoQixFQUE2QixFQUFFLElBQS9CO0FBQ0QsS0FGRCxNQUVPO0FBQ0wsZ0JBQVUsRUFBRSxPQUFaLEVBQXFCLEtBQXJCO0FBQ0Q7QUFDRixHQVJILEVBU0csS0FUSCxDQVNTLGFBQUs7QUFDVixjQUNFLDZCQUE2QixRQUE3QixHQUF3QyxXQUF4QyxHQUFzRCxDQUR4RCxFQUVFLEtBRkY7QUFJQSxRQUFJLFlBQVksT0FBaEIsRUFBeUIsUUFBUSxHQUFSLENBQVksQ0FBWjtBQUMxQixHQWZIO0FBZ0JELENBbkJEOztBQXNCQSxJQUFNLGdCQUFnQixTQUFoQixhQUFnQixDQUFDLEVBQUQsRUFBUTtBQUM1QixZQUFVLFFBQVYsRUFBb0IsS0FBcEIsRUFDRyxJQURILENBQ1EsYUFBSztBQUNULFFBQUksWUFBWSxPQUFoQixFQUF5QixRQUFRLEdBQVIsQ0FBWSxDQUFaO0FBQ3pCLFFBQUksUUFBUSxFQUFFLElBQWQ7QUFDQSxRQUFJLFVBQVUsRUFBZDtBQUNBLFNBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxNQUFNLE1BQTFCLEVBQWtDLEdBQWxDLEVBQXVDO0FBQ3JDLG1DQUEwQixNQUFNLENBQU4sRUFBUyxNQUFu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LGFBQUs7QUFDVixnQkFDRSw2QkFBNkIsS0FBSyxRQUFsQyxHQUE2QyxXQUE3QyxHQUEyRCxDQUQ3RCxFQUVFLEtBRkY7QUFJQSxVQUFJLFlBQVksT0FBaEIsRUFBeUIsUUFBUSxHQUFSLENBQVksQ0FBWjtBQUMxQixLQWpCSDtBQWtCRCxHQTVDRDtBQTZDRCxDQTNPRDs7QUE2T0Y7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiXHJcbiAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgLy8gVXNlcnMgbWFuYWdlIG1vZHVsZVxyXG4gIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG4gIGNvbnN0IHNlYXJjaFVzZXJOYW1lID0gdXNlck5hbWUgPT4ge1xyXG4gICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2codXNlck5hbWUpO1xyXG5cclxuICAgIGV4ZWNGZXRjaChcIi9zZWFyY2h1c2VyP3VzZXJOYW1lPVwiICsgdXNlck5hbWUsIFwiR0VUXCIsIG51bGwpXHJcbiAgICAgIC50aGVuKGQgPT4ge1xyXG4gICAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKGQpO1xyXG4gICAgICAgIGlmIChkLnN0YXR1cyA9PSBcIk9LXCIpIHtcclxuICAgICAgICAgIHNob3dBZGRVc2VyRm9ybShcIkVkaXQgVXNlclwiLCBkLmRhdGEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBzaG93VG9hc3QoZC5tZXNzYWdlLCBcImVyclwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICBzaG93VG9hc3QoXHJcbiAgICAgICAgICBcIkVycm9yIGFsIGJ1c2NhciB1c3VhcmlvIFwiICsgdXNlck5hbWUgKyBcIi48YnI+RXJyOlwiICsgZSxcclxuICAgICAgICAgIFwiZXJyXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgICB9KTtcclxuICB9O1xyXG5cclxuXHJcbiAgY29uc3QgTG9hZFVzZXJzTGlzdCA9IChlbCkgPT4ge1xyXG4gICAgZXhlY0ZldGNoKFwiL3VzZXJzXCIsIFwiR0VUXCIpXHJcbiAgICAgIC50aGVuKGQgPT4ge1xyXG4gICAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKGQpO1xyXG4gICAgICAgIGxldCB1c2VycyA9IGQuZGF0YTtcclxuICAgICAgICBsZXQgb3B0aW9ucyA9ICcnO1xyXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdXNlcnMubGVuZ3RoOyB4KyspIHtcclxuICAgICAgICAgIG9wdGlvbnMgKz0gYDxvcHRpb24gaWQ9XCIke3VzZXJzW3hdLlVzZXJJZH1cIj4ke3VzZXJzW3hdLlVzZXJOYW1lfTwvb3B0aW9uPmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsLmlubmVySFRNTCA9IG9wdGlvbnM7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICBzaG93VG9hc3QoXCJFcnJvciBhbCBncmFiYXIgbG9zIGNhbWJpb3MgcGFyYSBlbCB1c3VhcmlvIFwiICsgZGF0YS51c2VyTmFtZSArIFwiLjxicj5FcnI6XCIgKyBlLCBcImVyclwiKTtcclxuICAgICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKSBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZWRpdFVzZXIgPSAoKSA9PiB7XHJcbiAgICBsZXQgQWRkVXNlck1vZGFsQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjQWRkVXNlck1vZGFsQ29udGVudFwiKTtcclxuICAgIGxldCBTZWFyY2hVc2VyTW9kYWxDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIjc2VhcmNoVXNlck1vZGFsQ29udGVudFwiXHJcbiAgICApO1xyXG5cclxuXHJcbiAgICBsZXQgY29udGFpbmVyT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyLW92ZXJsYXlcIik7XHJcbiAgICBBZGRVc2VyTW9kYWxDb250ZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIFNlYXJjaFVzZXJNb2RhbENvbnRlbnQuaW5uZXJIVE1MID0gaHRtbFNlYXJjaFVzZXJUZW1wbGF0ZTtcclxuICAgIExvYWRVc2Vyc0xpc3QoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VzZXJzTGlzdCcpKTtcclxuICAgIFNlYXJjaFVzZXJNb2RhbENvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgIGNvbnRhaW5lck92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgIFNlYXJjaFVzZXJNb2RhbENvbnRlbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGUgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XHJcbiAgICAgICAgc2VhcmNoVXNlck5hbWUoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZWFyY2hVc2VyTmFtZVwiKS52YWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNidG5TZWFyY2hVc2VyXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBzZWFyY2hVc2VyTmFtZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlYXJjaFVzZXJOYW1lXCIpLnZhbHVlKTtcclxuICAgIH0pO1xyXG4gICAgZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjYnRuLVNlYXJjaFVzZXJDYW5jZWxcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgU2VhcmNoVXNlck1vZGFsQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgY29udGFpbmVyT3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIH0pO1xyXG4gIH07XHJcblxyXG5cclxuICBjb25zdCBzZWxlY3RSb2xlID0gKGVsZW1lbnQsIHJvbGUpID0+IHtcclxuICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKHJvbGUpO1xyXG4gICAgZm9yIChsZXQgeCA9IDA7IHggPCBlbGVtZW50Lm9wdGlvbnMubGVuZ3RoOyB4KyspIHtcclxuICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coXCJvcHRpb246IFwiLCBlbGVtZW50Lm9wdGlvbnNbeF0udGV4dCk7XHJcbiAgICAgIGlmIChlbGVtZW50Lm9wdGlvbnNbeF0udGV4dC50b1VwcGVyQ2FzZSgpID09PSByb2xlLnRvVXBwZXJDYXNlKCkpIHtcclxuICAgICAgICBlbGVtZW50Lm9wdGlvbnNbeF0uc2VsZWN0ZWQgPSBcInNlbGVjdGVkXCI7XHJcbiAgICAgICAgZWxlbWVudC5zZWxlY3RlZEluZGV4ID0geDtcclxuICAgICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKVxyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJvcHRpb24gc2VsZWN0ZWQ6IFwiLCBlbGVtZW50Lm9wdGlvbnNbeF0udGV4dCk7XHJcbiAgICAgICAgaWYgKHJvbGUudG9VcHBlckNhc2UoKSAhPT0gXCJDVVNUT01cIikge1xyXG4gICAgICAgICAgY2hhbmdlQWNjZXNzUmlnaHRzKFxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLkFjY2Vzc1JpZ2h0c1N3aXRjaFwiKSxcclxuICAgICAgICAgICAgZWxlbWVudC5vcHRpb25zW3hdLnZhbHVlXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IHNob3dBZGRVc2VyRm9ybSA9ICh0aXRsZSwgZGF0YSkgPT4ge1xyXG4gICAgbGV0IEFkZFVzZXJNb2RhbENvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0FkZFVzZXJNb2RhbENvbnRlbnRcIik7XHJcbiAgICBsZXQgY29udGFpbmVyT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGFpbmVyLW92ZXJsYXlcIik7XHJcbiAgICBsZXQgU2VhcmNoVXNlck1vZGFsQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI3NlYXJjaFVzZXJNb2RhbENvbnRlbnRcIlxyXG4gICAgKTtcclxuICAgIGxldCBtb2RlID0gZGF0YSA/IFwiZWRpdFwiIDogXCJhZGRcIjtcclxuICAgIGxldCBvbGREYXRhID0gbnVsbDtcclxuICAgIFNlYXJjaFVzZXJNb2RhbENvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cclxuICAgIEFkZFVzZXJNb2RhbENvbnRlbnQuaW5uZXJIVE1MID0gaHRtbFVzZXJGb3JtVGVtcGxhdGU7XHJcbiAgICBpZiAoZGF0YSkge1xyXG4gICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKSBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgb2xkRGF0YSA9IE9iamVjdC5hc3NpZ24oe30sIGRhdGEpO1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3VzZXJGb3JtVGl0bGVcIikuaW5uZXJIVE1MID0gdGl0bGU7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjVXNlck5hbWVcIikudmFsdWUgPSBkYXRhLlVzZXJOYW1lO1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0NvbXBhbnlOYW1lXCIpLnZhbHVlID0gZGF0YS5Db21wYW55TmFtZTtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNVc2VyUGFzc3dkXCIpLnZhbHVlID0gZGF0YS5Vc2VyUGFzc3dkO1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3JlcGVhdFVzZXJQYXNzd2RcIikudmFsdWUgPSBkYXRhLlVzZXJQYXNzd2Q7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjUm9vdFBhdGhcIikudmFsdWUgPSBkYXRhLlJvb3RQYXRoO1xyXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI0V4cGlyYXRlRGF0ZVwiKS52YWx1ZSA9IGRhdGEuRXhwaXJhdGVEYXRlO1xyXG4gICAgICAvL2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZXhwaXJhdGlvbkRhdGVcIilcclxuICAgICAgc2VsZWN0Um9sZShkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI1JvbGVPcHRpb25zXCIpLCBkYXRhLlJvbGUpO1xyXG4gICAgICBpZiAoZGF0YS5Sb2xlLnRvVXBwZXJDYXNlKCkgPT09IFwiQ1VTVE9NXCIpXHJcbiAgICAgICAgY2hlY2tBY2Nlc3NSaWdodHMoZGF0YS5BY2Nlc3NTdHJpbmcpO1xyXG4gICAgICBjb250YWluZXJPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgIEFkZFVzZXJNb2RhbENvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj1Vc2VyTmFtZV1cIikuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj1Db21wYW55TmFtZV1cIikuY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImxhYmVsW2Zvcj1Vc2VyUGFzc3dkXVwiKS5jbGFzc0xpc3QuYWRkKFwiYWN0aXZlXCIpO1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwibGFiZWxbZm9yPXJlcGVhdFVzZXJQYXNzd2RdXCIpXHJcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsYWJlbFtmb3I9Um9vdFBhdGhdXCIpLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjVXNlck5hbWVcIikuZGlzYWJsZWQgPSB0cnVlO1xyXG5cclxuICAgICAgZG9jdW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIiNidG4tYWRkVXNlckNhbmNlbFwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAvL2NvbnRhaW5lck92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgICAgQWRkVXNlck1vZGFsQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgICBTZWFyY2hVc2VyTW9kYWxDb250ZW50LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjYnRuLWFkZFVzZXJBY2VwdFwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBfdXBkYXRlVXNlcihvbGREYXRhKTtcclxuICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnRhaW5lck92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgQWRkVXNlck1vZGFsQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICBjaGFuZ2VBY2Nlc3NSaWdodHMoXHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5BY2Nlc3NSaWdodHNTd2l0Y2hcIiksXHJcbiAgICAgICAgXCJvcHQxXCJcclxuICAgICAgKTtcclxuICAgICAgZG9jdW1lbnRcclxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIiNidG4tYWRkVXNlckNhbmNlbFwiKVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZSA9PiB7XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICBjb250YWluZXJPdmVybGF5LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgIEFkZFVzZXJNb2RhbENvbnRlbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI2J0bi1hZGRVc2VyQWNlcHRcIilcclxuICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGUgPT4ge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgX2FkZFVzZXIoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgc2VsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNlbGVjdFwiKTtcclxuXHJcbiAgICAkKFwiLkFjY2Vzc1JpZ2h0c1N3aXRjaFwiKS5jaGFuZ2UoZnVuY3Rpb24gKCkge1xyXG4gICAgICBpZiAoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XHJcbiAgICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coXCJJcyBjaGVja2VkXCIpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKFwiSXMgTm90IGNoZWNrZWRcIik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHNlbC5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGUgPT4ge1xyXG4gICAgICBsZXQgb3B0ID0gZS50YXJnZXRbZS50YXJnZXQuc2VsZWN0ZWRJbmRleF0udmFsdWU7XHJcbiAgICAgIGxldCBBY2Nlc3NTd2l0Y2ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLkFjY2Vzc1JpZ2h0c1N3aXRjaFwiKTtcclxuICAgICAgY2hhbmdlQWNjZXNzUmlnaHRzKEFjY2Vzc1N3aXRjaCwgb3B0KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IF9nZXRVc2VyUm9sZSA9ICgpID0+IHtcclxuICAgICAgcmV0dXJuIHNlbC5vcHRpb25zW3NlbC5zZWxlY3RlZEluZGV4XS50ZXh0O1xyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBfZ2V0Q2hhbmdlcyA9ICgpID0+IHtcclxuICAgICAgbGV0IEFjY2Vzc1N3aXRjaCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuQWNjZXNzUmlnaHRzU3dpdGNoXCIpO1xyXG4gICAgICBsZXQgYWNjZXNzU3RyaW5nID0gX2dldEFjY2Vzc1N0cmluZyhBY2Nlc3NTd2l0Y2gpO1xyXG4gICAgICBsZXQgdXNlclJvbGUgPSBfZ2V0VXNlclJvbGUoKTtcclxuICAgICAgbGV0IHF1ZXJ5U3RyaW5nID0ge307XHJcbiAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKG9sZERhdGEpO1xyXG4gICAgICBmb3IgKGxldCBwcm9wIGluIG9sZERhdGEpIHtcclxuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvbGREYXRhLCBwcm9wKSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2cocHJvcCk7XHJcbiAgICAgICAgICBpZiAocHJvcCA9PT0gXCJSb2xlXCIpIHtcclxuICAgICAgICAgICAgaWYgKG9sZERhdGFbcHJvcF0udG9VcHBlckNhc2UoKSAhPT0gdXNlclJvbGUudG9VcHBlckNhc2UoKSkge1xyXG4gICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nLlJvbGUgPSB1c2VyUm9sZTtcclxuICAgICAgICAgICAgICBjb25zb2xlLndhcm4ob2xkRGF0YVtwcm9wXSwgdXNlclJvbGUpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKG9sZERhdGFbcHJvcF0sIHVzZXJSb2xlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHByb3AgPT09IFwiQWNjZXNzU3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICBpZiAob2xkRGF0YVtwcm9wXSAhPT0gYWNjZXNzU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4ob2xkRGF0YVtwcm9wXSwgYWNjZXNzU3RyaW5nKTtcclxuICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nLkFjY2Vzc1N0cmluZyA9IGFjY2Vzc1N0cmluZztcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cob2xkRGF0YVtwcm9wXSwgYWNjZXNzU3RyaW5nKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYgKHByb3AgPT09ICdFeHBpcmF0ZURhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkRGF0YVtwcm9wXSA9PT0gbnVsbCkgb2xkRGF0YVtwcm9wXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgaWYgKG9sZERhdGFbcHJvcF0gIT09IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb3ApLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nLkV4cGlyYXRlRGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHByb3ApLnZhbHVlXHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihvbGREYXRhW3Byb3BdLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcm9wKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhvbGREYXRhW3Byb3BdLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcm9wKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkRGF0YVtwcm9wXS50b1VwcGVyQ2FzZSgpICE9PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcm9wKS52YWx1ZS50b1VwcGVyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nW3Byb3BdID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocHJvcCkudmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihvbGREYXRhW3Byb3BdLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcm9wKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhvbGREYXRhW3Byb3BdLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwcm9wKS52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChSdW5Nb2RlID09PSAnREVCVUcnKSBjb25zb2xlLmxvZyhxdWVyeVN0cmluZyk7XHJcbiAgICAgIHJldHVybiBxdWVyeVN0cmluZztcclxuICAgIH07XHJcblxyXG4gICAgY29uc3QgX3VwZGF0ZVVzZXIgPSAob0RhdGEpID0+IHtcclxuICAgICAgbGV0IHF1ZXJ5U3RyaW5nID0gX2dldENoYW5nZXMoKTtcclxuICAgICAgaWYgKHF1ZXJ5U3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSB7XHJcbiAgICAgICAgICB1c2VyTmFtZTogb0RhdGEuVXNlck5hbWUsXHJcbiAgICAgICAgICBxdWVyeVN0cmluZzogcXVlcnlTdHJpbmdcclxuICAgICAgICB9O1xyXG4gICAgICAgIGV4ZWNGZXRjaChcIi91cGRhdGV1c2VyXCIsIFwiUE9TVFwiLCBkYXRhKVxyXG4gICAgICAgICAgLnRoZW4oZCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKGQpO1xyXG4gICAgICAgICAgICBzaG93VG9hc3QoXHJcbiAgICAgICAgICAgICAgXCJEYXRvcyB1c3VhcmlvIFwiICsgZGF0YS51c2VyTmFtZSArIFwiIGFjdHVhbGl6YWRvcy5cIixcclxuICAgICAgICAgICAgICBcInN1Y2Nlc3NcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlZnJlc2hcIikuY2xpY2soKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICAgIHNob3dUb2FzdChcclxuICAgICAgICAgICAgICBcIkVycm9yIGFsIGdyYWJhciBsb3MgY2FtYmlvcyBwYXJhIGVsIHVzdWFyaW8gXCIgK1xyXG4gICAgICAgICAgICAgIGRhdGEudXNlck5hbWUgK1xyXG4gICAgICAgICAgICAgIFwiLjxicj5FcnI6XCIgK1xyXG4gICAgICAgICAgICAgIGUsXHJcbiAgICAgICAgICAgICAgXCJlcnJcIlxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKSBjb25zb2xlLmxvZyhlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IF9nZXRBY2Nlc3NTdHJpbmcgPSBBY2Nlc3NTd2l0Y2ggPT4ge1xyXG4gICAgICBsZXQgcmVzdWx0ID0gXCJcIjtcclxuICAgICAgbGV0IHYgPSAwO1xyXG5cclxuICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCBBY2Nlc3NTd2l0Y2gubGVuZ3RoOyB4KyspIHtcclxuICAgICAgICBpZiAoQWNjZXNzU3dpdGNoW3hdLmNoZWNrZWQpIHtcclxuICAgICAgICAgIHYgPSAxO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHggIT0gMCkge1xyXG4gICAgICAgICAgcmVzdWx0ICs9IFwiLFwiICsgdjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzdWx0ICs9IHY7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IF9hZGRVc2VyID0gKCkgPT4ge1xyXG4gICAgICBsZXQgQWNjZXNzU3dpdGNoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5BY2Nlc3NSaWdodHNTd2l0Y2hcIik7XHJcbiAgICAgIGxldCB1c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjVXNlck5hbWVcIikudmFsdWU7XHJcbiAgICAgIGxldCBjb21wYW55TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjQ29tcGFueU5hbWVcIikudmFsdWU7XHJcbiAgICAgIGxldCB1c2VyUGFzc3dvcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI1VzZXJQYXNzd2RcIikudmFsdWU7XHJcbiAgICAgIGxldCB1c2VyUm9sZSA9IHNlbFtzZWwuc2VsZWN0ZWRJbmRleF0uaW5uZXJIVE1MO1xyXG4gICAgICBsZXQgdXNlclJvb3RQYXRoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNSb290UGF0aFwiKS52YWx1ZTtcclxuICAgICAgbGV0IGV4cGlyYXRlRGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjRXhwaXJhdGVEYXRlXCIpLnZhbHVlO1xyXG4gICAgICBsZXQgcmVzdWx0ID0gX2dldEFjY2Vzc1N0cmluZyhBY2Nlc3NTd2l0Y2gpO1xyXG5cclxuICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coXCJVc2VyIE5hbWU6IFwiICsgdXNlck5hbWUpO1xyXG4gICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKSBjb25zb2xlLmxvZyhcIkNvbXBhbnkgTmFtZTogXCIgKyBjb21wYW55TmFtZSk7XHJcbiAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKFwiUGFzc3dvcmQ6IFwiICsgdXNlclBhc3N3b3JkKTtcclxuICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coXCJSb290IFBhdGg6IFwiICsgdXNlclJvb3RQYXRoKTtcclxuICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coXCJFeHBpcmF0ZSBEYXRlOiBcIiArIGV4cGlyYXRlRGF0ZSk7XHJcbiAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKFwiUm9sZTogXCIgKyB1c2VyUm9sZSk7XHJcbiAgICAgIGlmIChSdW5Nb2RlID09PSBcIkRFQlVHXCIpIGNvbnNvbGUubG9nKFwiQWNjZXNzIFJpZ2h0czogXCIgKyByZXN1bHQpO1xyXG4gICAgICBsZXQgZGF0YSA9IHtcclxuICAgICAgICB1c2VyTmFtZTogdXNlck5hbWUsXHJcbiAgICAgICAgdXNlclBhc3N3b3JkOiBCYXNlNjQuZW5jb2RlKG1kNSh1c2VyUGFzc3dvcmQpKSxcclxuICAgICAgICBjb21wYW55TmFtZTogY29tcGFueU5hbWUsXHJcbiAgICAgICAgdXNlclJvbGU6IHVzZXJSb2xlLFxyXG4gICAgICAgIGV4cGlyYXRlRGF0ZTogZXhwaXJhdGVEYXRlLFxyXG4gICAgICAgIHJvb3RQYXRoOiB1c2VyUm9vdFBhdGgsXHJcbiAgICAgICAgYWNjZXNzUmlnaHRzOiByZXN1bHRcclxuICAgICAgfTtcclxuICAgICAgZXhlY0ZldGNoKFwiL2FkZHVzZXJcIiwgXCJQT1NUXCIsIGRhdGEpXHJcbiAgICAgICAgLnRoZW4oZCA9PiB7XHJcbiAgICAgICAgICBpZiAoUnVuTW9kZSA9PT0gXCJERUJVR1wiKSBjb25zb2xlLmxvZyhkKTtcclxuICAgICAgICAgIHNob3dUb2FzdChcIlVzdWFyaW8gXCIgKyBkYXRhLnVzZXJOYW1lICsgXCIgYcOxYWRpZG8uXCIsIFwic3VjY2Vzc1wiKTtcclxuICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVmcmVzaFwiKS5jbGljaygpO1xyXG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmb3JtQWRkVXNlclwiKS5yZXNldCgpO1xyXG4gICAgICAgICAgY2hhbmdlQWNjZXNzUmlnaHRzKFxyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLkFjY2Vzc1JpZ2h0c1N3aXRjaFwiKSxcclxuICAgICAgICAgICAgXCJvcHQxXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZSA9PiB7XHJcbiAgICAgICAgICBzaG93VG9hc3QoXHJcbiAgICAgICAgICAgIFwiRXJyb3IgYWwgYcOxYWRpciB1c3VhcmlvIFwiICsgZGF0YS51c2VyTmFtZSArIFwiLjxicj5FcnI6XCIgKyBlLFxyXG4gICAgICAgICAgICBcImVyclwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgaWYgKFJ1bk1vZGUgPT09IFwiREVCVUdcIikgY29uc29sZS5sb2coZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gIH07XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gRW5kIHVzZXIgbWFuYWdlIG1vZHVsZVxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4gIFxyXG4iXX0=
